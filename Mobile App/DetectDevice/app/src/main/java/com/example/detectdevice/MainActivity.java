package com.example.detectdevice;

import androidx.appcompat.app.AppCompatActivity;

import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.os.Build;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ListView;
import android.widget.TextView;

import java.security.AccessController;
import java.util.Arrays;
import java.util.List;

public class MainActivity extends AppCompatActivity {

    // capture button

    Button btn_detect;
    Button btn_installApp;
    Button btn_viewProduct;
    ListView list_packages;
    ListView list_viewID;
    DetectPhoneConfiguratoin detect = new DetectPhoneConfiguratoin();
    String model = detect.model();
    String version = detect.version();
    String hardware= detect.serialNO();
    String cpu = detect.cpu();
    String deviceType = detect.device();
    String manufacturer = detect.manufacturer();

   String device [] = {model, version};


   // 1. CALLING OS INSTALLED PRODUCT CLASS
    DetectInstalledProduct detectProduct = new DetectInstalledProduct();




    // listview adapter

    public static class MyAdapter extends ArrayAdapter<String> implements com.example.detectdevice.MyAdapter {
        public MyAdapter(Context context, List<String> data) {
            super(context, 0, data);
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            View view = convertView;
            if (view == null) {
                view = LayoutInflater.from(getContext()).inflate(android.R.layout.simple_list_item_1, parent, false);
            }
            TextView textView = view.findViewById(android.R.id.text1);
            textView.setText(getItem(position));
            return view;
        }
    }





    @Override
    protected void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // assign value
        btn_detect = findViewById(R.id.btn_detect);
        btn_installApp = findViewById(R.id.btn_installApp);


        list_viewID = findViewById(R.id.list_viewID);
        List<String> data = Arrays.asList("Model: "+model, "Android Version: "+version,
                 "Device Type: "+deviceType, "Manufacturer: " + manufacturer, "CPU: "+cpu);
        MyAdapter adapter = new MyAdapter(this, data);
        //list_viewID.setAdapter(adapter);



//        ArrayAdapter<String> arrayAdapter = new ArrayAdapter<String>
//                (this, R.layout.activity_list_view, R.id.textView, device );
//        list_viewID.setAdapter(arrayAdapter);

        //onItemClickListener
//        list_viewID.setOnItemClickListener(new AdapterView.OnItemClickListener() {
//            @Override
//            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
//                // Handle click event here
//            }
//        });


        // click listener for button1
        btn_detect.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                list_viewID.setAdapter(adapter);

 //               Toast.makeText(MainActivity.this, "Phone Model: " +model, Toast.LENGTH_LONG).show();
//                Toast.makeText(MainActivity.this, "Android Version : " +version, Toast.LENGTH_SHORT).show();

            }
        });

        // click listener for button2
        btn_installApp.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                openActivity2();
            }
        });



        // 2. INSTALLED PRODUCTS.

        PackageManager packageManager = getPackageManager();

        // Get the operating system version
        String osVersion = Build.VERSION.RELEASE;

        // Get the list of all installed system packages
        List<PackageInfo> systemPackages = detectProduct.getSystemInstalledPackages(packageManager);

        // Get the list of all installed non-system packages
        List<PackageInfo> userPackages = detectProduct.getUserInstalledPackages(packageManager);

        // new list array
        //List<String> package_data = Arrays.asList("Model: "+model, "Android Version: "+version,
          //      "Device Type: "+deviceType, "Manufacturer: " + manufacturer, "CPU: "+cpu);
        //MyAdapter package_adapter = new MyAdapter(this, package_data);
        //
        // Get the name and version of each package
        for (PackageInfo packageInfo : systemPackages) {
            String packageName = packageInfo.packageName;
            String versionName = detectProduct.getVersionName(packageManager, packageName);
            List<String> package_data = Arrays.asList("System Package:: "+ packageName + " (" + versionName + ")");
            MyAdapter package_adapter = new MyAdapter(this, package_data);
            //System.out.println("System Package: " + packageName + " (" + versionName + ")");
        }
        for (PackageInfo packageInfo : userPackages) {
            String packageName = packageInfo.packageName;
            String versionName = detectProduct.getVersionName(packageManager, packageName);
            System.out.println("User Package: " + packageName + " (" + versionName + ")");
        }

        // Get the name of the device's default web browser
        String defaultBrowserName = detectProduct.getDefaultBrowserName(packageManager);
        System.out.println("Default Browser: " + defaultBrowserName);

    }

    public void openActivity2(){
        Intent intent = new Intent(this, MainActivity2.class );
        startActivity(intent);
    }
}